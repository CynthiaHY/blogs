---
layout: post
title: "DevOps pipeline for deploying OpenLiberty applications into AWS Elastic container service"
categories: blog
author_picture: https://avatars3.githubusercontent.com/shamjithantholi
author_github: https://github.com/shamjithantholi
seo-title: DevOps pipeline for deploying OpenLiberty applications into AWS Elastic container service
seo-description: Steps to develop DevOps pipeline on AWS platform for deploying OpenLiberty applications using AWS codepipeline, AWS codecommit, AWS codebuild and AWS Elastic container service.
blog_description: Steps to develop DevOps pipeline on AWS platform for deploying OpenLiberty applications using AWS codepipeline, AWS codecommit, AWS codebuild and AWS Elastic container service.
open-graph-image: https://openliberty.io/img/blog/aws-ecs-devops-devops-generic-architecture.png
---
= DevOps pipeline for deploying OpenLiberty applications into AWS Elastic container service
Shamjith Antholi <https://github.com/shamjithantholi>
:imagesdir: /
:url-prefix:
:url-about: /

[#Intro]

## AWS devops introduction

This blog contains the steps to build DevOps pipeline on AWS platform 

== Setting AWS networking components for Elastic container services(ECS)

=== VPC

Create a new VPC with custom CIDR whose IP range will be used to host all the associated components of this pipeline.

Login to link:http://aws.amazon.com[AWS] and search for VPC and enter the details as given below

image::/img/blog/create-vpc.png[Create VPC,width=80%,align="left"]

Edit the "DNS hostnames" of this new VPC and enable it

image::/img/blog/edit-dns-hostnames.png[Edit DNS hostnames,width=80%,align="left"]

Edit the "DNS resolution" of this new VPC and enable it

image::/img/blog/edit-dns-resolutions.png[Edit DNS resolutions,width=80%,align="left"]

== Subnets and Internet Gateway

We need to create a private subnet within the VPC to define the hosted applications access to internal (private). Internet gateways are created and configured to route the traffic to load balancer 

=== Route table

Login to link:http://aws.amazon.com[AWS]  and go to VPC --> Route tables and create a new route table

image::/img/blog/create-route-table.png[Create Route table,width=80%,align="left"]

=== Private subnet

Login to link:http://aws.amazon.com[AWS]  and go to VPC --> Subnets and create 2 private subnets which is hosted on 2  different availability zones

image::/img/blog/create-private-subnet1.png[Create private subnet,width=80%,align="left"]

image::/img/blog/create-private-subnet2.png[Create private subnet,width=80%,align="left"]

=== Internet Gateway

Login to link:http://aws.amazon.com[AWS]  and go to VPC --> Internet gateways and create a new Internet Gateway

image::/img/blog/create-internet-gateway.png[Create Internet gateway,width=80%,align="left"]

Select this new internet gateway and attached it to above created VPC

image::/img/blog/attach-igw-to-vpc.png[Attach internet gateway to VPC,width=80%,align="left"]

== Configure Route tables

Login to link:http://aws.amazon.com[AWS] and Go to the route table created earlier and then go to "Subnet associations tab" and then click on "Edit subnet association"

image::/img/blog/route-table-config-2.png[Route table configuration - subnet association ,width=80%,align="left"]

Select the 2 private subnets selected and click on save 

image::/img/blog/route-table-config-5.png[Route table configuration - subnet association ,width=80%,align="left"]

Login to link:http://aws.amazon.com[AWS] and Go to the route table created earlier and then go to "Routes tab"

image::/img/blog/route-table-config-1.png[Route table configuration,width=80%,align="left"]

Click on "Edit route" and then on "Add route" and select earlier created internet gateway as the target (select 0.0.0.0/0 as destination IP)

image::/img/blog/route-table-config-4.png[Route table configuration,width=80%,align="left"]

== Endpoints

Create ECR DKR endpoint

image::/img/blog/endpoint-ecr-dkr3.png[ECR DKR endpoint,width=80%,align="left"]

image::/img/blog/endpoint-ecr-dkr4.png[ECR DKR endpoint,width=80%,align="left"]

Create ECR API endpoint

image::/img/blog/endpoint-ecr-api1.png[ECR API endpoint,width=80%,align="left"]

image::/img/blog/endpoint-ecr-api2.png[ECR API endpoint,width=80%,align="left"]

Create S3 endpoint (gateway)

image::/img/blog/openliberty-ep-s3-1.png[ECR S3 endpoint,width=80%,align="left"]

image::/img/blog/openliberty-ep-s3-2.png[ECR S3 endpoint,width=80%,align="left"]

Create LOGS endpoint

image::/img/blog/openliberty-ep-logs-1.png[ECR S3 endpoint,width=80%,align="left"]

image::/img/blog/openliberty-ep-logs-2.png[ECR S3 endpoint,width=80%,align="left"]



VPC
private subnet
nat gateway
route table - nat
ecs endpoints
load balancer
target group
open liberty image
ECS - with no public IP
ECS with LB


== What is MicroProfile and Open Liberty


link:https://openliberty.io/[Open Liberty] is a lightweight open source Javaâ„¢ runtime that is built by using modular features. 

== About MicroProfile config and containerization

image::/img/blog/ol-configuration1.png[Open Liberty configuration file flow,width=100%,align="left"]

Use commands similar to below given to copy files to pods from local
*kubectl cp /tmp/samplefile.txt <container-namespace>/<pod-id>:/tmp/*

