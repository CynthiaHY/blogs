---
layout: post
title: "DevOps pipeline for deploying OpenLiberty applications into AWS Elastic container service"
categories: blog
author_picture: https://avatars3.githubusercontent.com/shamjithantholi
author_github: https://github.com/shamjithantholi
seo-title: DevOps pipeline for deploying OpenLiberty applications into AWS Elastic container service
seo-description: Steps to develop DevOps pipeline on AWS platform for deploying OpenLiberty applications using AWS codepipeline, AWS codecommit, AWS codebuild and AWS Elastic container service.
blog_description: Steps to develop DevOps pipeline on AWS platform for deploying OpenLiberty applications using AWS codepipeline, AWS codecommit, AWS codebuild and AWS Elastic container service.
open-graph-image: https://openliberty.io/img/blog/aws-ecs-devops-devops-generic-architecture.png
---
= DevOps pipeline for deploying OpenLiberty applications into AWS Elastic container service
Shamjith Antholi <https://github.com/shamjithantholi>
:imagesdir: /
:url-prefix:
:url-about: /

[#Intro]

## AWS devops introduction

This blog contains the steps to build DevOps pipeline on AWS platform 

== Setting AWS networking components for Elastic container services(ECS)

=== VPC

Create a new VPC with custom CIDR whose IP range will be used to host all the associated components of this pipeline.

Login to link:http://aws.amazon.com[AWS] and search for VPC and enter the details as given below

image::/img/blog/create-vpc.png[Create VPC,width=80%,align="left"]

Edit the "DNS hostnames" of this new VPC and enable it

image::/img/blog/edit-dns-hostnames.png[Edit DNS hostnames,width=80%,align="left"]

Edit the "DNS resolution" of this new VPC and enable it

image::/img/blog/edit-dns-resolutions.png[Edit DNS resolutions,width=80%,align="left"]

== Subnets and Gateways (NAT and Internet)

We need to create private and public subnet within the VPC to define the hosted applications access to internal (private) or external (public). NAT gateways are associated with private subnet to restrict the traffic only to the internal network and Internet gateways are created and configured to route the traffic to external networks 

=== Route table

Login to link:http://aws.amazon.com[AWS]  and go to VPC --> Route tables and create a new route table

image::/img/blog/create-route-table.png[Create Route table,width=80%,align="left"]

=== Private subnet

Login to link:http://aws.amazon.com[AWS]  and go to VPC --> Subnets and create a new private subnet

image::/img/blog/create-private-subnet.png[Create private subnet,width=80%,align="left"]

=== Public subnet

Login to link:http://aws.amazon.com[AWS]  and go to VPC --> Subnets and create a new private subnet

image::/img/blog/create-public-subnet.png[Create public subnet,width=80%,align="left"]

=== NAT Gateway

Login to link:http://aws.amazon.com[AWS]  and go to VPC --> NAT gateways and create a new NAT Gateway

image::/img/blog/create-nat-gateway.png[Create NAT gateway,width=80%,align="left"]

Select the private subnet which we created earlier from the "Subnet" dropdown, also allocate an elastic IP to the NAT gateway

=== Internet Gateway

Login to link:http://aws.amazon.com[AWS]  and go to VPC --> Internet gateways and create a new Internet Gateway

image::/img/blog/create-internet-gateway.png[Create Internet gateway,width=80%,align="left"]

Select this new internet gateway and attached it to above created VPC

image::/img/blog/attach-igw-to-vpc.png[Attach internet gateway to VPC,width=80%,align="left"]

== Configure Route tables

Login to link:http://aws.amazon.com[AWS] and Go to the route table created earlier and then go to "Subnet associations tab" and then click on "Edit subnet association"

image::/img/blog/route-table-config-2.png[Route table configuration - subnet association ,width=80%,align="left"]

Select the public subnet selected earlier 

image::/img/blog/route-table-config-3.png[Route table configuration - subnet association ,width=80%,align="left"]

Login to link:http://aws.amazon.com[AWS] and Go to the route table created earlier and then go to "Routes tab"

image::/img/blog/route-table-config-1.png[Route table configuration,width=80%,align="left"]

Click on "Edit route" and then on "Add route" and select earlier created internet gateway as the target (select 0.0.0.0/0 as destination IP)

image::/img/blog/route-table-config-4.png[Route table configuration,width=80%,align="left"]


VPC
private subnet
nat gateway
route table - nat
ecs endpoints
load balancer
target group
open liberty image
ECS - with no public IP
ECS with LB


== What is MicroProfile and Open Liberty


link:https://openliberty.io/[Open Liberty] is a lightweight open source Javaâ„¢ runtime that is built by using modular features. 

== About MicroProfile config and containerization

image::/img/blog/ol-configuration1.png[Open Liberty configuration file flow,width=100%,align="left"]

Use commands similar to below given to copy files to pods from local
*kubectl cp /tmp/samplefile.txt <container-namespace>/<pod-id>:/tmp/*

