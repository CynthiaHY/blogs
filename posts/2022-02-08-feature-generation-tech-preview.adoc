---
layout: post
title: "Introducing automatic generation of features in Liberty server configuration (Tech Preview)"
# Do NOT change the categories section
categories: blog
author_picture: https://avatars3.githubusercontent.com/kathrynkodama
author_github: https://github.com/kathrynkodama
seo-title: Introducing automatic generation of features in Liberty server configuration (Tech Preview) - OpenLiberty.io
seo-description: Tech Preview - Open liberty's dev mode automatically generates Liberty server configuration features as you iteratively develop your cloud-native Java applications.
blog_description: "Tech Preview - Open liberty's dev mode automatically generates Liberty server configuration features as you iteratively develop your cloud-native Java applications."
open-graph-image: https://openliberty.io/img/twitter_card.jpg
---
= Introducing automatic generation of features in Liberty server configuration (Tech Preview)
Kathryn Kodama <https://github.com/kathrynkodama>
:imagesdir: /
:url-prefix:
:url-about: /

In this post, we introduce a technology preview for automatically generating a list of features in your project's Liberty server configuration (server.xml). As part of Liberty dev mode, features will now be automatically generated in your server configuration as you develop your cloud-native Java application.

Dev mode will monitor the class files in your application and detect new Liberty feature API usage. If dev mode detects features that are not already specified in your server configuration, a new `generated-features.xml` file will be created in your configuration directory located at `configDropins/overrides`. This simplifies your developer workflow as you no longer need to manually specify these features. We recommend that you commit this new `generated-features.xml` file to your version control. Note that user specified features will always take precedence over automatically generated features so the automatically generated features will not replace or conflict with features you have already specified in your `server.xml`.

This feature is enabled by default in the `3.5.2-SNAPSHOT` of the https://github.com/OpenLiberty/ci.maven[Liberty Maven Plugin] and the `3.3.1-SNAPSHOT` of the https://github.com/OpenLiberty/ci.gradle[Liberty Gradle Plugin]. We invite you to try it out and let us know your thoughts so that we can make it even more useful for your development scenarios.

== Dev mode with automatic generation of features

For Maven projects, specify the Liberty Maven Plugin with version `3.5.2-SNAPSHOT` and its Sonatype repository in your `pom.xml` file:
[source,xml]
----
    <pluginRepositories>
        <pluginRepository>
            <id>sonatype</id>
            <url>https://oss.sonatype.org/content/repositories/snapshots</url>
        </pluginRepository>
    </pluginRepositories>
    <repositories>
        <repository>
            <id>sonatype</id>
            <url>https://oss.sonatype.org/content/repositories/snapshots</url>
        </repository>
    </repositories>

<plugin>
    <groupId>io.openliberty.tools</groupId>
    <artifactId>liberty-maven-plugin</artifactId>
    <version>3.5.2-SNAPSHOT</version>
</plugin>
----

For Gradle projects, specify the Liberty Gradle Plugin with version `3.3.1-SNAPSHOT` and its Sonatype repository in your `build.gradle` file:
[source, groovy]
----
apply plugin: 'liberty'

buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
        maven {
            url "https://plugins.gradle.org/m2"
            url "https://oss.sonatype.org/content/repositories/snapshots"
        }
    }
    dependencies {
        classpath 'io.openliberty.tools:liberty-gradle-plugin:3.3.1-SNAPSHOT'
    }
}
----

Start dev mode as usual. Automatic generation of features is on by default in the technology preview (snapshot release).
Maven: `mvn liberty:dev`
Gradle: `gradle libertyDev`

image::/img/blog/liberty-dev-startup.png[Liberty dev mode startup with automatic generation of features on,width=70%,align="center"]

As you make code changes to your application, dev mode will monitor your API usage in your class files. Then, it will automatically generate and install a new Liberty feature if needed. The feature list will be generated in a new file `configDropins/overrides/generated-features.xml` in the configuration directory of your project.

image::/img/blog/liberty-generate-features-increment.png[Liberty dev mode generating features after code change,width=70%,align="center"]
[source, xml]
----
<?xml version="1.0" encoding="UTF-8"?>
<server>
    <!--This file was generated by the Liberty Maven Plugin and will be overwritten on subsequent runs of the liberty:generate-features goal.
 It is recommended that you do not edit this file and that you commit this file to your version control.-->
    <featureManager>
        <!--The following features were generated based on API usage detected in your application-->
        <feature>cdi-2.0</feature>
        <feature>mpHealth-3.0</feature>
        <feature>mpMetrics-3.0</feature>
        <feature>jaxrs-2.1</feature>
    </featureManager>
</server>
----

As you make changes to your application, dev mode will only scan class files that have just been modified for API usage. However, you may run into a scenario where a feature has been generated that is no longer used in any of your classes. You can have dev mode re-scan all class files in your application and generate an "optimized" list of features by typing 'o' and pressing Enter in the dev mode terminal.

image::/img/blog/liberty-generate-features-optimize.png[Liberty dev mode optimizing features generated,width=70%,align="center"]

== Disabling automatic generation of features in dev mode

If you would like to disable the automatic generation of features, you can set the `generateFeatures` parameter to false.
Maven: `mvn liberty:dev -DgenerateFeatures=false`
Gradle: `gradle libertyDev --generateFeatures=false`

While running dev mode you can toggle generate features on/off by typing 'g' and pressing Enter in the dev mode terminal.

image::/img/blog/liberty-generate-features-toggle.png[Liberty dev mode toggling features generation,width=70%,align="center"]

== Dev mode help menu

Also included in this latest snapshot release is a new help menu view in dev mode. By typing 'h' and pressing Enter in the dev mode terminal, you will be able to see a list of hotkeys and actions you can perform in dev mode.

image::/img/blog/liberty-dev-help-menu.png[Liberty dev mode help menu,width=70%,align="center"]

== Automatically generating features outside of dev mode

To generate a server configuration feature list for your application outside of dev mode, compile your project and run the new generate features goal/task standalone. You will need to run the "installFeatures" goal/task afterwards to install the features.

Maven: `mvn compile liberty:generate-features`
Gradle: `mvn compileJava generateFeatures`

image::/img/blog/liberty-generate-features-standalone-goal.png[Liberty Maven Plugin generate-features standalone goal,width=70%,align="center"]

== Additional Resources

To try out automatic generation of features on a demo project, see the https://github.com/OpenLiberty/demo-devmode/tree/generate-features[generate-features branch of the demo-devmode project].

For more information, see the official documentation for the `liberty:generate-features` goal of the https://github.com/OpenLiberty/ci.maven/blob/main/docs/generate-features.md[Liberty Maven Plugin] or the `generateFeatures` task of the https://github.com/OpenLiberty/ci.gradle/blob/main/docs/generateFeatures.md[Liberty Gradle Plugin].

Try out the technology preview and we welcome your feedback. You can post in the https://gitter.im/OpenLiberty/developer-experience[Open Liberty developer experience channel on Gitter] or open issues directly in the https://github.com/OpenLiberty/ci.maven/issues[Liberty Maven Plugin] or https://github.com/OpenLiberty/ci.gradle/issues[Liberty Gradle Plugin] GitHub repositories.