---
layout: post
title: "OpenLiberty and Microprofile configuration file management in multiple kubernetes environments"
categories: blog
author_picture: https://avatars3.githubusercontent.com/shamjithantholi
author_github: https://github.com/shamjithantholi
seo-title: OpenLiberty and Microprofile configuration file management in multiple kubernetes environments
seo-description: Methods to manage OpenLiberty and Microprofile configuration files in multiple kubernetes environments.
blog_description: Methods to manage OpenLiberty and Microprofile configuration files in multiple kubernetes environments.
open-graph-image: https://openliberty.io/img/blog/liberty-devops-generic-architecture.png
---
= OpenLiberty and Microprofile configuration file management in multiple kubernetes environments
Shamjith Antholi <https://github.com/shamjithantholi>
:imagesdir: /
:url-prefix:
:url-about: /

[#Intro]

=== What is microprofile and OpenLiberty
The link:https://microprofile.io[MicroProfile] specification consists of a collection of Enterprise Java APIs and technologies that together form a core baseline for microservices that aims to deliver application portability across multiple runtimes.

link:https://openliberty.io/?_ga=2.75178834.1545551050.1658778682-1210051418.1658778682[Open Liberty] is a lightweight open source Javaâ„¢ runtime that is built by using modular features. link:https://www.ibm.com/cloud/websphere-liberty[WebSphere Liberty] is a commercial version of Open Liberty.

=== About Microprofile config
Parameter values directly written in the code file as constants are not an acceptable coding standard anymore, instead, all the parameter instances are externalized in different formats (.java, .properties, .xml), either create a 'constant' files of any format separately from the source code and read values directly from it or by creating variables in the code and feeding values to it from the environment variable on run time from the hosted environment. 

Microprofile and OpenLiberty have standardized the use of these parameter files with additional properties like ordianls. Different type of files where the parameter values and variable (constants and run time type) can be hosted are 

    1. server.xml
    2. Environment variables
    3. microprofile-config.properties
    4. bootstrap.properties
    5. server.env
    6. CustomConfig properties (anything which implement org.eclipse.microprofile.config.spi.ConfigSource)

Applications need to be hosted on multiple environments for various purposes and hence there is a requirement to design applications with run time parameters. Various types of configuration files are used to inject parameters into applications on run time. When application configurations are modified at run time, applications may or may not be required to be restarted for the changes to be in effect in application. We are discussing about these configurations files in this blog. Different configuration options available in Open Liberty applications hosted on containerized environment are  


All these property files contains an ordinal value to set the reading order of the file by the application. 


#Various configuration files in OL & MP including custom config   

#what is kubernetes & Data injection into containers on multiple environments

#Architectural diagram of config files flow through various kubernetes environment starting from GitHub

== Different data injection methods in Kubernetes/OpenShift

There are multiple ways with which you can inject data into containers. This blog will discuss about mutiple types of Microprofile and OpenLiberty configuration files and the ways to inject dynamic values into the corresponding variable in the docker container. 

For the purpose of demonstration, i have defined variables in below given files and the values for the same is injected from different container data sources.

server.xml&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;microprofile-config.properties

[cols=">a,<a", frame=none, grid=none]
|===
| image::/img/blog/server-xml.png[server.xml file variable view,width=70%,align="left"]
| image::/img/blog/microprofile.png[microprofile config file variable view,width=70%,align="right"]
|===

botstrap.properties&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server.env

[cols=">a,<a", frame=none, grid=none]
|===
| image::/img/blog/bootstrap.png[bootstrap.properties file variable view,width=70%,align="left"]
| image::/img/blog/server-env.png[server.env file variable view,width=70%,align="right"]
|===

CustomConfigSource.json

[cols=">a,<a", frame=none, grid=none]
|===
| image::/img/blog/customconfigsource.png[Custom config source file variable view,width=70%,align="left"]
| 
|===



=== Environment variables

PODS can define environment variables directly in the pod defenition yaml configuration and application code can use it. Any change in environment variables will need a pod restart for the change to take effect in the code.

image::/img/blog/OpenShift-deployment.png[OpenShift environment variable view,width=70%,align="center"]

When the container is restarted, the values from this environment variables are injected into application in the container, a sample result is show below

image::/img/blog/env-variable-results.png[Environment variable result view,width=70%,align="center"]

#Config maps - with dynamic and static values

#Volumes with passing files to containers

#secrets

#YAML way or direct POD configuration ways

#Restart pods or no-restart options

== Managing configurations details from through different kubernetes environments

#Github branches

#pull requests

== Conclusion

