---
layout: post
title: "MicroProfile GraphQL 2.0, security vulnerability (CVE) and bug fixes in Open Liberty 22.0.0.6"
# Do NOT change the categories section
categories: blog
author_picture: https://avatars3.githubusercontent.com/ryan-storey
author_github: https://github.com/ryan-storey
seo-title: MicroProfile GraphQL 2.0, security vulnerability (CVE) and bug fixes in Open Liberty 22.0.0.6 - OpenLiberty.io
seo-description: Open Liberty 22.0.0.6 offers MicroProfile GraphQL 2.0, which incorporates Jakarta EE 9.1 dependencies, allowing the use of updated Jakarta components such as CDI 3.0, Jakarta REST 3.0, JSON-B 2.0 and more. This release also contains a number of significant bug fixes as well as important security vulnerability (CVE) fixes.
blog_description: Open Liberty 22.0.0.6 offers MicroProfile GraphQL 2.0, which incorporates Jakarta EE 9.1 dependencies, allowing the use of updated Jakarta components such as CDI 3.0, Jakarta REST 3.0, JSON-B 2.0 and more. This release also contains a number of significant bug fixes as well as important security vulnerability (CVE) fixes.
open-graph-image: https://openliberty.io/img/twitter_card.jpg
---
= MicroProfile GraphQL 2.0, security vulnerability (CVE) and bug fixes in Open Liberty 22.0.0.6
Ryan Storey <https://github.com/ryan-storey>
:imagesdir: /
:url-prefix:
:url-about: /
//Blank line here is necessary before starting the body of the post.

Open Liberty 22.0.0.6 offers MicroProfile GraphQL 2.0, which incorporates Jakarta EE 9.1 dependencies, allowing the use of updated Jakarta components such as CDI 3.0, Jakarta REST 3.0, JSON-B 2.0 and more. This release also contains a number of significant bug fixes as well as important security vulnerability (CVE) fixes.

In link:{url-about}[Open Liberty] 22.0.0.6:

* <<graphql, MicroProfile GraphQL 2.0>>
* <<cve, Security Vulnerability (CVE) Fixes>>
* <<bugs, Notable bug fixes>>

View the list of fixed bugs in link:https://github.com/OpenLiberty/open-liberty/issues?q=label%3Arelease%3A22006+label%3A%22release+bug%22[22.0.0.6].

[#run]
== Run your apps using 22.0.0.6

If you're using link:{url-prefix}/guides/maven-intro.html[Maven], here are the coordinates:

[source,xml]
----
<dependency>
    <groupId>io.openliberty</groupId>
    <artifactId>openliberty-runtime</artifactId>
    <version>22.0.0.6</version>
    <type>zip</type>
</dependency>
----

Or for link:{url-prefix}/guides/gradle-intro.html[Gradle]:

[source,gradle]
----
dependencies {
    libertyRuntime group: 'io.openliberty', name: 'openliberty-runtime', version: '[22.0.0.6,)'
}
----

Or if you're using Docker:

[source]
----
FROM open-liberty
----

Or take a look at our link:{url-prefix}/downloads/[Downloads page].

[link=https://stackoverflow.com/tags/open-liberty]
image::img/blog/blog_btn_stack.svg[Ask a question on Stack Overflow, align="center"]

[#graphql]
=== MicroProfile GraphQL 2.0

MicroProfile GraphQL 2.0 incorporates Jakarta EE 9.1 dependencies.  This allows developers to continue using the same functionality provided by MP GraphQL 1.0 but with the updated Jakarta features such as link:{url-prefix}/docs/latest/reference/feature/cdi-3.0.html[CDI 3.0], link:{url-prefix}/docs/latest/reference/feature/restfulWS-3.0.html[restfulWS 3.0], link:{url-prefix}/docs/latest/reference/feature/jsonb-2.0.html[JSON-B 2.0], etc. Functionally, version 2.0 behaves the same as 1.0 because it uses the same version of the underlying implementation (link:https://github.com/smallrye/smallrye-graphql[SmallRye GraphQL]).  If you'd like to learn more about MicroProfile GraphQL, check out our link:{url-prefix}/guides/microprofile-graphql.htm[Optimizing REST queries for microservices with GraphQL] guide or see our previous link:{url-prefix}/blog/2020/06/10/microprofile-graphql-open-liberty.html[blog post about MicroProfile GraphQL 1.0] and our link:{url-prefix}/blog/2020/08/28/graphql-apis-open-liberty-20009.html[blog post on how to use the GraphiQL UI and third-party Client APIs].

To enable the MicroProfile GraphQL 2.0 feature, add it to your `server.xml`:

[source, xml]
----
<featureManager>
  <feature>mpGraphQL-2.0</feature>
</featureManager>
----

[#cve]
== Security vulnerability (CVE) fixes in this release
[cols="5*"]
|===
|CVE |CVSS Score |Vulnerability Assessment |Versions Affected |Notes

|link:http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22475[CVE-2022-22475]
|5 |Identity spoofing |17.0.0.3 - 22.0.0.5 |Affects the link:{url-prefix}/docs/latest/reference/feature/appSecurity-1.0.html[App Security 1.0], link:{url-prefix}/docs/latest/reference/feature/appSecurity-2.0.html[App Security 2.0], link:{url-prefix}/docs/latest/reference/feature/appSecurity-3.0.html[App Security 3.0] and link:{url-prefix}/docs/latest/reference/feature/appSecurity-4.0.html[App Security 4.0] features
|link:http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22393[CVE-2022-22393] | 3.1 | Information disclosure | 17.0.0.3 - 22.0.0.5 | Affects the link:{url-prefix}/docs/latest/reference/feature/adminCenter-1.0.html[Admin Center 1.0] feature
|===

For a list of past security vulnerability fixes, reference the link:{url-prefix}/docs/latest/security-vulnerabilities.html[Security vulnerability (CVE) list].

[#bugs]
== Notable bugs fixed in this release

We’ve spent some time fixing bugs. The following sections describe just some of the issues resolved in this release. If you’re interested, here’s the  link:https://github.com/OpenLiberty/open-liberty/issues?q=label%3Arelease%3A22006+label%3A%22release+bug%22[full list of bugs fixed in 22.0.0.6].

* link:https://github.com/OpenLiberty/open-liberty/issues/21050[Liberty OIDC error is being returned with incorrect characters]
+
Previously, Liberty's `OIDC` error was returned with incorrect characters. When invoking the OP's `/authorize` endpoint with missing or incorrect parameters in traditional Chinese, the returned error message had a number of `????` instead of Chinese characters. The same happened for other non-ascii languages.
+
The error page showed:
+
[source]
----
"Accept-Language: zh-TW"
HTTP/1.1 200 OK
X-Powered-By: Servlet/3.0
Content-Language: en-DE
Transfer-Encoding: chunked
Date: Fri, 06 May 2022 08:42:36 GMT

CWOAU0033E: ????????????client_id
----
+
This issue has now been fixed and the page should contain the properly translated error message instead of `????????????`.

* link:https://github.com/OpenLiberty/open-liberty/issues/21079[Refresh token is not cleaned up when a JWT access_token had been issued]
+
`OIDC` `end_session`'s `refresh_token` cleanup is different depending on the type of access_token issued.
The Liberty OP can issue opaque or JWT `access_tokens`. When running `end_session`, the `refresh_token` is removed from the cache when creating opaque `access_tokens`, however when creating JWT `access_tokens`, the `refresh_token` was NOT removed. This issue has been resolved and running `end_session` on providers that generate JWT access_tokens should invalidate the `refresh_token`.

* link:https://github.com/OpenLiberty/open-liberty/issues/21097[Custom claims not passed to the back end]
+
When using MicroProfile Starter `start.microprofile.io` to generate `service-a` and `service-b` running on Open Liberty, the invocation to the service `b` no longer sent out the custom claim on invoking the JWT backend via `localhost:9080`. This defect was caused by the changes which exposed a hidden problem in the `Claims.putAll` method when there were claims with a null value and has since been fixed.

* link:https://github.com/OpenLiberty/open-liberty/issues/21043[Bump netty dependencies to 4.1.77.Final]
+
Netty components in Open Liberty were of the version `4.1.75.Final` released in March 2022. The latest version `4.1.77.Final` contains various bug fixes and improvements over the current version. These components have been updated to ensure that Open Liberty stays up to date with upstream fixes and improvements.

* link:https://github.com/OpenLiberty/open-liberty/issues/20908[Default session meta cache name failed with RH DataGrid]
+
When Liberty created `infinispan` caches name with percent encoding, Datagrid Administration GUI Console failed to retrieve the cache name. An example would be:
+
[source]
----
com.ibm.ws.session.meta.default_host%2FGestionPedidos
----
+
Where `GestionPedidos` is the application web context, `%2F` is the encoded character for `/`. RH DataGrid failed to retrieve the above cache name.

== Get Open Liberty 22.0.0.6 now

Available through <<run,Maven, Gradle, Docker, and as a downloadable archive>>.
